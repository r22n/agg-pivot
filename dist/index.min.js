(()=>{var e={10:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defagg=s.aggregate=s.frombuf=void 0;const o=t(960),r=t(610);s.frombuf=function(e,s){const t={headers:{names:e.slice(0,s),cols:{}},distinct:{},table:e.slice(s),rows:(e.length-s)/s};t.headers.names.forEach(((e,s)=>{t.headers.cols[e]=s,t.distinct[e]={}}));const a=(0,r.fromary)(t.table,[t.rows,t.headers.names.length]);for(const[e,s]of(0,o.seq)([0,0],[t.headers.names.length,t.rows])){const o=t.headers.names[e],r=t.headers.cols[o],c=a.get(s,r);t.distinct[o][c]=1}return t},s.aggregate=function(e,t){const a={rows:[],cols:[],sums:t.sums.concat(),table:{}},c={rows:t.rows.map((s=>Object.keys(e.distinct[s]))),cols:t.cols.map((s=>Object.keys(e.distinct[s])))},n=(0,r.fromary)(e.table,[e.rows,e.headers.names.length]);(0,o.seq)(t.rows.map((()=>0)),t.rows.map(((e,s)=>c.rows[s].length))).forEach((e=>{a.rows.push(e.map(((e,s)=>({value:c.rows[s][e],name:t.rows[s]}))))})),(0,o.seq)(t.cols.map((()=>0)),t.cols.map(((e,s)=>c.cols[s].length))).forEach((e=>{a.cols.push(e.map(((e,s)=>({value:c.cols[s][e],name:t.cols[s]}))))}));const l=Object.assign({},s.defagg,t.agg),u={rows:t.rows.length?a.rows.map((e=>e.map((({value:e})=>e)).reduce(l.keys))):[],cols:t.cols.length?a.cols.map((e=>e.map((({value:e})=>e)).reduce(l.keys))):[],sums:a.sums.reduce(l.keys)};a.rows.map(((s,t)=>a.cols.map(((o,r)=>a.sums.map((c=>{const d=l.rcid(u.rows[t],u.cols[r],c);if(!l.postif(s,o))return;let m=l.zero;for(let t=0;t<e.rows;t++)if([...s,...o].every((({name:s,value:o})=>n.get(t,e.headers.cols[s])===o))){const r=l.cast(n.get(t,e.headers.cols[c]));m=l.add(m,r,s,o)}a.table[d]=l.post(m)}))))));const d=[{name:l.wkey,value:l.wkey}];return a.rows.map(((s,t)=>a.sums.map((o=>{const r=l.rcid(u.rows[t],l.wkey,o);if(!l.postif(s,d))return;let c=l.zero;for(let t=0;t<e.rows;t++)if(s.every((({name:s,value:o})=>n.get(t,e.headers.cols[s])===o))){const r=l.cast(n.get(t,e.headers.cols[o]));c=l.add(c,r,s,d)}a.table[r]=l.post(c)})))),a.cols.map(((s,t)=>a.sums.map((o=>{const r=l.rcid(l.wkey,u.cols[t],o);if(!l.postif(d,s))return;let c=l.zero;for(let t=0;t<e.rows;t++)if(s.every((({name:s,value:o})=>n.get(t,e.headers.cols[s])===o))){const r=l.cast(n.get(t,e.headers.cols[o]));c=l.add(c,r,d,s)}a.table[r]=l.post(c)})))),a.sums.map((s=>{const t=l.rcid(l.wkey,l.wkey,s);if(!l.postif(d,d))return;let o=l.zero;for(let t=0;t<e.rows;t++){const r=l.cast(n.get(t,e.headers.cols[s]));o=l.add(o,r,d,d)}a.table[t]=l.post(o)})),a},s.defagg={add:(e,s)=>e+s,keys:(e,s)=>`${e}/${s}`,wkey:"*",rcid:(e,s,t)=>`${e}&${s}&${t}`,zero:0,cast:e=>{const s=Number(e);return isNaN(s)?0:s},post:e=>e,postif:()=>!0}},610:(e,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.fromary=void 0,s.fromary=function(e,s){if(s.some((e=>e<=0)))return;const t=s.map((()=>1));for(let e=t.length-2;e>=0;e--)t[e]=s[e+1]*t[e+1];return{source:e,length:s.concat(),product:t,get:(...s)=>e[s.map(((e,s)=>t[s]*e)).reduce(((e,s)=>e+s))],set(s,...o){const r=o.map(((e,s)=>t[s]*e)).reduce(((e,s)=>e+s));return e[r]=s,r}}}},960:(e,s)=>{"use strict";function t(e,s){let t=e.length-1;for(;t>=0&&++e[t]>=s[t];t--)e[t]=0;return t}Object.defineProperty(s,"__esModule",{value:!0}),s.seq=s.next=void 0,s.next=t,s.seq=function(e,s){if(!s.length||s.some((e=>0===e)))return[];const o=[];for(let r=e.concat(),a=0;-1!==a;a=t(r,s))o.push(r.concat());return o}}},s={};function t(o){var r=s[o];if(void 0!==r)return r.exports;var a=s[o]={exports:{}};return e[o](a,a.exports,t),a.exports}(()=>{const{defagg:e,aggregate:s,frombuf:o}=t(10);window.aggpivot={defagg:e,aggregate:s,frombuf:o}})()})();